<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Vehículo</title>
    <!-- Bootstrap CSS  -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom css -->
    <link rel="stylesheet" th:href="@{/css/components/abm.css}" />
    <link rel="stylesheet" th:href="@{/css/components/formAuth.css}" />
    <link rel="stylesheet" th:href="@{/css/global/index.css}" />
    <!-- SweetAlert2 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
</head>
<body class="d-flex flex-column min-vh-100">

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
        <a class="navbar-brand" th:href="@{/}">MUDAYA</a>
        <div class="collapse navbar-collapse">
            <ul class="navbar-nav me-auto">
                <li class="nav-item"><a class="nav-link" th:href="@{/}">Inicio</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/clients}">Clientes</a></li>
                <li class="nav-item"><a class="nav-link active" th:href="@{/vehicles}">Vehículos</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/transporters}">Transporters</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/movings}">Mudanzas</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/signout}"><i class="fas fa-sign-out-alt"></i> Salir</a></li>
            </ul>
            <span class="navbar-text text-light"><i class="fas fa-user"></i> [[${session.currentUser.name}]]</span>
        </div>
    </div>
</nav>

<main>
    <section class="container-custom my-5">
        <div class="container">
            <h2 th:if="${vehicle.id} != null">Editar Vehículo</h2>
            <h2 th:if="${vehicle.id} == null">Nuevo Vehículo</h2>
            <hr/>

            <!-- Formulario edición -->
            <form th:if="${vehicle.id} != null"
                  th:action="@{/vehicles/edit/{id}(id=${vehicle.id})}"
                  th:object="${vehicle}"
                  method="post">
                <input type="hidden" th:field="*{id}" />

                <div class="mb-3">
                    <label class="form-label">Marca</label>
                    <input th:field="*{brand}" class="form-control" required />
                </div>
                <div class="mb-3">
                    <label class="form-label">Modelo</label>
                    <input th:field="*{model}" class="form-control" required />
                </div>
                <div class="mb-3">
                    <label class="form-label">Patente</label>
                    <input th:field="*{licensePlate}" class="form-control" required disabled/>
                </div>
                <div class="mb-3">
                    <label class="form-label">Color</label>
                    <input th:field="*{color}" class="form-control" />
                </div>
                <div class="mb-3">
                    <label class="form-label">Tipo</label>
                    <select th:field="*{type}" class="form-select" required>
                        <option th:each="t : ${T(com.mudaya.mudaya.domain.enums.VehicleType).values()}"
                                th:value="${t}" th:text="${t}">TIPO</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label">Capacidad (kg)</label>
                    <input th:field="*{capacityKg}" type="number" step="0.01" class="form-control" required />
                </div>
                <div class="mb-3">
                    <label class="form-label">Área (m²)</label>
                    <input th:field="*{areaM2}" type="number" step="0.01" class="form-control" required />
                </div>
                <div class="mb-3">
                    <label class="form-label">Volumen (m³)</label>
                    <input th:field="*{volumeM3}" type="number" step="0.01" class="form-control" required />
                </div>

                <button type="submit" class="btn btn-primary me-2">Actualizar</button>
                <a th:href="@{/vehicles}" class="btn btn-secondary">Cancelar</a>
            </form>

            <!-- Formulario creación -->
            <form th:if="${vehicle.id} == null"
                  th:action="@{/vehicles}"
                  th:object="${vehicle}"
                  method="post">
                <div class="mb-3">
                    <label class="form-label">Marca</label>
                    <input th:field="*{brand}" class="form-control" required />
                </div>
                <div class="mb-3">
                    <label class="form-label">Modelo</label>
                    <input th:field="*{model}" class="form-control" required />
                </div>
                <div class="mb-3">
                    <label class="form-label">Patente</label>
                    <input th:field="*{licensePlate}" class="form-control" required />
                </div>
                <div class="mb-3">
                    <label class="form-label">Color</label>
                    <input th:field="*{color}" class="form-control" />
                </div>
                <div class="mb-3">
                    <label class="form-label">Tipo</label>
                    <select th:field="*{type}" class="form-select" required>
                        <option th:each="t : ${T(com.mudaya.mudaya.domain.enums.VehicleType).values()}"
                                th:value="${t}" th:text="${t}">TIPO</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label">Capacidad (kg)</label>
                    <input th:field="*{capacityKg}" type="number" step="0.01" class="form-control" required />
                </div>
                <div class="mb-3">
                    <label class="form-label">Área (m²)</label>
                    <input th:field="*{areaM2}" type="number" step="0.01" class="form-control" required />
                </div>
                <div class="mb-3">
                    <label class="form-label">Volumen (m³)</label>
                    <input th:field="*{volumeM3}" type="number" step="0.01" class="form-control" required />
                </div>

                <button type="submit" class="btn btn-success me-2">Crear</button>
                <a th:href="@{/vehicles}" class="btn btn-secondary">Cancelar</a>
            </form>
        </div>
    </section>
</main>

<footer th:replace="components/footer :: footer" class="mt-auto"></footer>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- SweetAlert2 JS -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<!-- Alerta de éxito-->
<script th:if="${successMessage}" th:inline="javascript">
    /*<![CDATA[*/
    Swal.fire({ icon:'success', title:'¡Exito!', text:[[${successMessage}]], timer:2000, showConfirmButton:false });
    /*]]>*/
</script>

<!-- Alerta de error-->
<script th:if="${formError}" th:inline="javascript">
    /*<![CDATA[*/
    Swal.fire({ icon:'error', title:'¡Error!', text:[[${formError}]] });
    /*]]>*/
</script>

</body>
</html>