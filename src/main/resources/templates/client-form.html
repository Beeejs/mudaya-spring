<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Cliente</title>
    <!-- Bootstrap CSS  -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom css -->
    <link rel="stylesheet" th:href="@{/css/components/abm.css}" />
    <link rel="stylesheet" th:href="@{/css/components/formAuth.css}" />
    <link rel="stylesheet" th:href="@{/css/global/index.css}" />
    <!-- SweetAlert2 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
</head>
<body class="d-flex flex-column min-vh-100">

    <!-- Navbar -->
    <div th:replace="components/navbar :: navbar"></div>

    <!-- CONTENIDO PRINCIPAL -->
    <main >
        <section class="container-custom">
           <div class="container">
               <!-- TÍTULOS -->
               <h2 th:if="${client.id != null}">Editar Cliente</h2>
               <h2 th:if="${client.id == null}">Nuevo Cliente</h2>
               <hr/>

               <!-- FORMULARIO EDICIÓN -->
               <form th:if="${client.id != null}"
                     th:action="@{/clients/edit/{id}(id=${client.id})}"
                     th:object="${client}"
                     method="post">
                   <input type="hidden" th:field="*{id}" />

                   <div class="mb-3">
                       <label class="form-label">Nombre</label>
                       <input th:field="*{name}" class="form-control" required />
                   </div>

                   <div class="mb-3">
                       <label class="form-label">Apellido</label>
                       <input th:field="*{surname}" class="form-control" required />
                   </div>

                   <div class="mb-3">
                       <label class="form-label">Teléfono</label>
                       <input th:field="*{phoneNumber}" class="form-control" required />
                   </div>

                   <div class="mb-3">
                       <label class="form-label">DNI</label>
                       <input th:field="*{dni}" class="form-control" required />
                   </div>

                   <div class="mb-3">
                       <label class="form-label">Sexo</label>
                       <select th:field="*{sexo}" class="form-select" required>
                           <option value="M">Masculino</option>
                           <option value="F">Femenino</option>
                       </select>
                   </div>

                   <button type="submit" class="btn btn-primary me-2">Actualizar</button>
                   <a href="/clients" class="btn btn-secondary">Cancelar</a>
               </form>

               <!-- FORMULARIO CREACIÓN -->
               <form th:if="${client.id == null}"
                     th:action="@{/clients}"
                     th:object="${client}"
                     method="post">
                   <div class="mb-3">
                       <label class="form-label">Nombre</label>
                       <input th:field="*{name}" class="form-control" required />
                   </div>

                   <div class="mb-3">
                       <label class="form-label">Apellido</label>
                       <input th:field="*{surname}" class="form-control" required />
                   </div>

                   <div class="mb-3">
                       <label class="form-label">Teléfono</label>
                       <input th:field="*{phoneNumber}" class="form-control" required />
                   </div>

                   <div class="mb-3">
                       <label class="form-label">DNI</label>
                       <input th:field="*{dni}" class="form-control" required />
                   </div>

                   <div class="mb-3">
                       <label class="form-label">Sexo</label>
                       <select th:field="*{sexo}" class="form-select" required>
                           <option value="M">Masculino</option>
                           <option value="F">Femenino</option>
                       </select>
                   </div>

                   <button type="submit" class="btn btn-success me-2">Crear</button>
                   <a href="/clients" class="btn btn-secondary">Cancelar</a>
               </form>
           </div>
        </section>
    </main>

    <!-- FOOTER -->
    <footer th:replace="components/footer :: footer" class="mt-auto"></footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- SweetAlert2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Alerta de exito-->
    <script th:if="${successMessage}" th:inline="javascript">
        /*<![CDATA[*/
        Swal.fire({
            icon: 'success',
            title: '¡Éxito!',
            text: [[${successMessage}]],
            timer: 2000,
            showConfirmButton: false
        });
        /*]]>*/
    </script>

    <!-- Alerta de error -->
    <script th:if="${formError}" th:inline="javascript">
        /*<![CDATA[*/
        Swal.fire({
            icon: 'error',
            title: '¡Error!',
            text: [[${formError}]]
        });
        /*]]>*/
    </script>
</body>
</html>
